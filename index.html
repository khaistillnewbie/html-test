<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- iOS + favicon -->
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" href="icon.png" type="image/png">
<meta name="theme-color" content="#ffffff">

<title>Spending Tracker PRO</title>

<style>
:root{
  --bg:#f6f7fb; --card:#fff; --primary:#4f46e5;
  --cash:#22c55e; --qr:#0ea5e9; --cc:#f59e0b;
  --text:#1f2937; --muted:#6b7280;
}
body{
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:var(--bg); margin:0; padding:16px;
}
.center{text-align:center;}
h2{margin:0;}
.subtitle{color:var(--muted); font-size:14px; margin-bottom:20px;}

.dashboard-container{
  display:flex; gap:10px; margin-bottom:20px;
}
.dashboard-card{
  flex:1;
  background:var(--card);
  border-radius:12px;
  padding:16px;
  box-shadow:0 8px 16px rgba(0,0,0,0.05);
  text-align:center;
  cursor:pointer;
}
.dashboard-card h3{margin:0;font-size:14px;color:var(--muted);}
.dashboard-card p{margin-top:6px;font-size:18px;font-weight:600;}

.card{
  background:var(--card);
  border-radius:12px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 10px 20px rgba(0,0,0,0.06);
}
label{display:block;font-size:13px;color:var(--muted);margin-top:10px;}
input,select,button{
  width:100%;padding:12px;margin-top:6px;
  border-radius:10px;border:1px solid #e5e7eb;
  font-size:15px;
}
button{
  border:none;background:var(--primary);
  color:white;font-weight:600;cursor:pointer;
}
table{
  width:100%;border-collapse:collapse;font-size:13px;
}
th,td{
  padding:10px;border-bottom:1px solid #e5e7eb;
}
th{background:#f3f4f6;}
footer{text-align:center;font-size:12px;color:var(--muted);}
</style>
</head>

<body>

<div class="center">
  <h2>Spending Tracker PRO</h2>
  <div class="subtitle">
    ‚ÄúAwareness is the first step to wealth.‚Äù
  </div>
</div>

<div class="dashboard-container">
  <div class="dashboard-card" id="dashCash" data-pay="Cash" style="border-top:4px solid var(--cash)">
    <h3>Cash</h3><p>RM0.00</p>
  </div>
  <div class="dashboard-card" id="dashQR" data-pay="QR" style="border-top:4px solid var(--qr)">
    <h3>QR</h3><p>RM0.00</p>
  </div>
  <div class="dashboard-card" id="dashCC" data-pay="Credit Card" style="border-top:4px solid var(--cc)">
    <h3>Credit Card</h3><p>RM0.00</p>
  </div>
</div>

<div class="card">
  <label>Date & Time</label>
  <input type="datetime-local" id="datetime">

  <label>Description</label>
  <input type="text" id="desc">

  <label>Category</label>
  <select id="category">
    <option>Makanan/Minuman</option>
    <option>Physical Shopping</option>
    <option>Online Shopping</option>
    <option>Minyak</option>
    <option>Topup Phone</option>
    <option>Capcut</option>
    <option>Lain-lain</option>
  </select>

  <label>Payment</label>
  <select id="payment">
    <option>Cash</option>
    <option>QR</option>
    <option>Credit Card</option>
  </select>

  <label>Amount (RM)</label>
  <input type="number" id="amount" step="0.01">

  <button onclick="addEntry()">+ Add Spending</button>
</div>

<div class="card">
  <button onclick="exportCSV()">üì§ Export CSV</button>
  <input type="file" accept=".csv" onchange="importCSV(event)">
</div>

<div class="card">
  <table>
    <thead>
      <tr>
        <th>Date</th><th>Description</th>
        <th>Category</th><th>Payment</th><th>RM</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>
</div>

<footer>Made by Khai ‚ù§Ô∏è</footer>

<script>
let data = JSON.parse(localStorage.getItem("spendingData")) || [];
let filter = null;

// default datetime now
document.getElementById("datetime").value =
  new Date().toISOString().slice(0,16);

function saveData(){
  localStorage.setItem("spendingData", JSON.stringify(data));
}

function render(){
  const tbody = document.getElementById("tableBody");
  tbody.innerHTML = "";
  let sum = {Cash:0, QR:0, "Credit Card":0};

  data.forEach(d=>{
    if(filter && d.payment!==filter) return;
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${d.datetime.replace("T"," ")}</td>
      <td>${d.desc}</td>
      <td>${d.category}</td>
      <td>${d.payment}</td>
      <td>${d.amount.toFixed(2)}</td>`;
    tbody.appendChild(tr);
    sum[d.payment]+=d.amount;
  });

  document.querySelector("#dashCash p").innerText=`RM${sum.Cash.toFixed(2)}`;
  document.querySelector("#dashQR p").innerText=`RM${sum.QR.toFixed(2)}`;
  document.querySelector("#dashCC p").innerText=`RM${sum["Credit Card"].toFixed(2)}`;
}

function addEntry(){
  if(!desc.value||!amount.value) return alert("Isi semua dulu");
  data.push({
    datetime:datetime.value,
    desc:desc.value,
    category:category.value,
    payment:payment.value,
    amount:parseFloat(amount.value)
  });
  saveData();
  desc.value=""; amount.value="";
  render();
}

function exportCSV(){
  let csv="Date,Description,Category,Payment,Amount\n";
  data.forEach(d=>{
    csv+=`${d.datetime},${d.desc},${d.category},${d.payment},${d.amount}\n`;
  });
  const blob=new Blob([csv],{type:"text/csv"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="spending.csv";
  a.click();
}

function importCSV(e){
  const r=new FileReader();
  r.onload=()=>{
    r.result.split("\n").slice(1).forEach(l=>{
      if(!l) return;
      const [dt,desc,cat,pay,amt]=l.split(",");
      data.push({datetime:dt,desc,category:cat,payment:pay,amount:+amt});
    });
    saveData();
    render();
  };
  r.readAsText(e.target.files[0]);
}

document.querySelectorAll(".dashboard-card").forEach(c=>{
  c.onclick=()=>{
    filter = filter===c.dataset.pay ? null : c.dataset.pay;
    render();
  }
});

render();
</script>
</body>
</html>
